Script started on 2020ë…„ 12ì›” 20ì¼ (ì¼) ì˜¤í›„ 11ì‹œ 36ë¶„ 00ì´ˆ
[?1034hnetpa15@~/project/ 1000$ cat projcli.c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <strings.h>
#include <fcntl.h>
#include <sys/time.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>

#define MAXLINE 1000
#define NAME_LEN 20

char *EXIT_STRING = "exit";
int tcp_connect(int af, char *servip, unsigned short port);
void errquit(char *msg) { perror(msg); exit(1); }

int main(int argc, char *argv[]) {
        char buf[MAXLINE+1];
        int maxfdp1,s;
        fd_set read_fds;
        char* name;


        if(argc != 4) {
                printf("Usage : %s server_ip port name\n", argv[0]);
                exit(0);
        }
name=argv[3];


        s = tcp_connect(AF_INET, argv[1], atoi(argv[2]));
        if(s == -1)
                errquit("tcp_connect fail");
        puts("ì„œë²„ì— ì ‘ì†ë˜ì—ˆìŠµë‹ˆë‹¤.");
        maxfdp1 = s+1;
        FD_ZERO(&read_fds);
        if(send(s, name, strlen(name), 0) < 0)
            puts("Error : write error on socket");

        while(1) {
                FD_SET(0, &read_fds);
                FD_SET(s, &read_fds);
                if(select(maxfdp1, &read_fds, NULL, NULL, NULL)<0)
                        errquit("select fail");
                if(FD_ISSET(s, &read_fds)) {
                        int nbyte;
                        if((nbyte=recv(s, buf, MAXLINE, 0)) > 0) {
                                buf[nbyte] = 0;
if(strstr(buf,EXIT_STRING)!=NULL){
close(s);
exit(0);
}
                                printf("%s \n", buf);
                        }
                }
                if(FD_ISSET(0, &read_fds)) {
                        if(fgets(buf, MAXLINE, stdin)) {
                                if(send(s, buf, strlen(buf), 0) < 0)
                                        puts("Error : write error on socket");
                                if(strstr(buf, EXIT_STRING) != NULL) {
                                        puts("Good bye");
                                        close(s);
                                        exit(0);
                                }
                        }
                }
        }
}

int tcp_connect(int af, char *servip, unsigned short port) {
        struct sockaddr_in servaddr;
        int s;

        if((s = socket(af, SOCK_STREAM, 0)) < 0)
                return -1;

        bzero((char *)&servaddr, sizeof(servaddr));
        servaddr.sin_family = af;
        inet_pton(AF_INET, servip, &servaddr.sin_addr);
        servaddr.sin_port = htons(port);

        if(connect(s, (struct sockaddr *)&servaddr, sizeof(servaddr)) < 0)
                return -1;
        return s;
}

netpa15@~/project/ 1001$ ./projcli 127.0.0.1 4015 gaeun
ì„œë²„ì— ì ‘ì†ë˜ì—ˆìŠµë‹ˆë‹¤.
ì¡°ê±´ì´ ì¶©ì¡±í•˜ì§€ ì•Šì•„ ê²Œì„ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 
 
ì¡°ê±´ì´ ì¶©ì¡±í•˜ì—¬ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤.
-ì¸ë””ì–¸ í¬ì»¤ ê·œì¹™-
1ëŒ€ 1 ë°©ì‹ì˜ ê²Œì„ì´ë©° ê°ê°ì˜ í”Œë ˆì´ì–´ëŠ” 10ê°œì˜ ì¹´ë“œ(1~10)ì™€ ì¹©(15ê°œ)ì„ ì§€ê¸‰ë°›ìŠµë‹ˆë‹¤.
ê° ë¼ìš´ë“œë§ˆë‹¤ ìƒëŒ€ë°©ì˜ ì¹´ë“œë¥¼ ë³¼ìˆ˜ìˆìœ¼ë©° ì¹´ë“œë¥¼ ë³´ê³  ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼(1ê°œ ì´ìƒ) ê²°ì •í•©ë‹ˆë‹¤.
ê·¸ í›„ ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜ì™€ ìƒëŒ€ë°©ì˜ ì¹´ë“œì˜ ìˆ˜ë¥¼ ë³´ê³  ìŠ¹ë¶€ë¥¼ ì§„í–‰í• ì§€ ê²°ì •í•©ë‹ˆë‹¤.
ë§Œì•½ ë‹¹ì‹ ì´ ìŠ¹ë¶€ì— ì„í•˜ê³  ìƒëŒ€ë°©ë„ ìŠ¹ë¶€ì— ì„í–ˆì„ì‹œì—ëŠ” ì¹´ë“œíŒ¨ê°€ ë†’ì€ ì‚¬ëŒì´ ì´ê¸°ë©° íŒ¨ë°°í•œ ì‚¬ëŒì´ ë°°íŒ…í•œ ì¹©ì˜ ìˆ˜ ë§Œí¼ ì´ê¸°ì‚¬ëŒì´ ê°€ì ¸ê°‘ë‹ˆë‹¤.
 
----------------------------------------------
 
ë¼ìš´ë“œ 1
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 15
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 3
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~15) 
5
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 3

ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
y
ë‹¹ì‹ ì´ ì´ê²¼ìŠµë‹ˆë‹¤.

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 6 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
ë¼ìš´ë“œ 2
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 18
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 10
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~18) 
18
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 3

ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
y
ë‹¹ì‹ ì´ ì´ê²¼ìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 7 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
ë¼ìš´ë“œ 3
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 18
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 5
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~18) 
3
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 7

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
n
ë‹¹ì‹ ì´ ì¡ŒìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 1 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
 
ë¼ìš´ë“œ 4
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 16
 
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 2
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~16) 
5
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 5

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
n
ë¹„ê²¼ìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 3 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
 
ë¼ìš´ë“œ 5
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 16
 
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 6
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~16) 
5
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 7

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
n
ë‹¹ì‹ ì´ ì¡ŒìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 10 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
 
ë¼ìš´ë“œ 6
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 11
 
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 8
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~11) 
1
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 3

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
y
ë‹¹ì‹ ì´ ì¡ŒìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 4 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
ë¼ìš´ë“œ 7
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 10
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 4
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~10) 
5
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 5

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
n
ë¹„ê²¼ìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 5 ì˜€ìŠµë‹ˆë‹¤.
 
----------------------------------------------
 
ë¼ìš´ë“œ 8
 
ë‹¹ì‹ ì˜ ì¹©ì˜ ê°œìˆ˜: 10
 
ìƒëŒ€ë°©ì˜ ì¹´ë“œ ìˆ«ì: 1
 
ë°°íŒ…í•  ì¹©ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”(1~10) 
10
ìƒëŒ€ë°©ì´ ë°°íŒ…í•œ ì¹©ì˜ ê°œìˆ˜: 8

 
ìŠ¹ë¶€ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?(y/n) 
y
ë‹¹ì‹ ì´ ì´ê²¼ìŠµë‹ˆë‹¤.
 

ë‹¹ì‹ ì˜ ì¹´ë“œì˜ ìˆ«ìëŠ” 2 ì˜€ìŠµë‹ˆë‹¤.
 

ìƒëŒ€ë°©ì˜ ì¹©ì´ 0ê°œê°€ ë˜ì–´ ì§„í–‰ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.
 ë‹¹ì‹ ì€ ìŠ¹ë¦¬í•˜ì…¨ìŠµë‹ˆë‹¤!
 
netpa15@~/project/ 1002$ exit

Script done on 2020ë…„ 12ì›” 20ì¼ (ì¼) ì˜¤í›„ 11ì‹œ 39ë¶„ 20ì´ˆ
